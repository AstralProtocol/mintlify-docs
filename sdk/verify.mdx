---
title: "Verify"
description: "astral.verify.*, astral.stamps.*, astral.proofs.* — Location proof verification"
---

<Warning>
  **Research Preview** — Under active development.
</Warning>

# Verify Module

The Verify module provides **evidence-based verification of location claims**. It includes three namespaces:

- `astral.stamps.*` — Evidence collection (client-side)
- `astral.proofs.*` — Proof construction
- `astral.verify.*` — Verification operations (server-side)

<Info>
  For conceptual background, see [Location Proofs](/concepts/location-proofs).
</Info>

## Quick Start

```typescript
import { astral } from '@decentralized-geo/astral-sdk';

// 1. Collect evidence
const pluginOptions = { name: 'proofmode', version: '0.1.0' };
const signals = await astral.stamps.collect(pluginOptions);
const unsigned = await astral.stamps.create(pluginOptions, signals);
const stamp = await astral.stamps.sign(unsigned, signer);

// 2. Create claim (extends Location Protocol)
const claim = {
  lpVersion: '0.2',
  locationType: 'geojson-point',
  location: { type: 'Point', coordinates: [-122.4194, 37.7749] },
  srs: 'http://www.opengis.net/def/crs/OGC/1.3/CRS84',
  subject: { scheme: 'eth-address', value: '0x...' },
  radius: 100,
  time: { start: Date.now() / 1000 - 60, end: Date.now() / 1000 }
};

// 3. Bundle into proof and verify
const proof = astral.proofs.create(claim, [stamp]);
const result = await astral.verify.proof(proof);

console.log(result.credibility.confidence);  // 0.85
```

---

## astral.stamps.*

Methods for collecting and packaging location evidence on the client.

### collect

Collect raw signals from the environment using a plugin.

```typescript
const signals = await astral.stamps.collect(pluginOptions);
```

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `pluginOptions.name` | `string` | Yes | Plugin name: `"proofmode"` or `"witnesschain"` |
| `pluginOptions.version` | `string` | Yes | Plugin version (semver) |
| `pluginOptions.config` | `object` | No | Plugin-specific configuration |

**Returns:** `Promise<RawSignals>` — Plugin-specific signal data

**Example:**

```typescript
const signals = await astral.stamps.collect({
  name: 'proofmode',
  version: '0.1.0',
  config: { timeout: 5000 }
});
```

### create

Process raw signals into an unsigned stamp.

```typescript
const unsigned = await astral.stamps.create(pluginOptions, signals);
```

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `pluginOptions` | `PluginOptions` | Yes | Plugin name and version |
| `signals` | `RawSignals` | Yes | Output from `collect()` |

**Returns:** `Promise<UnsignedStamp>` — Stamp ready for signing

**Example:**

```typescript
const unsigned = await astral.stamps.create(pluginOptions, signals);

console.log(unsigned.location);           // Observed location (LP format)
console.log(unsigned.temporalFootprint);  // { start, end }
```

### sign

Sign an unsigned stamp with a key.

```typescript
const stamp = await astral.stamps.sign(unsigned, signer);
```

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `unsigned` | `UnsignedStamp` | Yes | Output from `create()` |
| `signer` | `Signer` | Yes | Signing key (ethers Signer or compatible) |

**Returns:** `Promise<LocationStamp>` — Signed stamp ready for verification

---

## astral.proofs.*

Methods for constructing location proofs.

### create

Bundle a claim with stamps into a location proof.

```typescript
const proof = astral.proofs.create(claim, stamps);
```

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `claim` | `LocationClaim` | Yes | The location claim |
| `stamps` | `LocationStamp[]` | Yes | One or more signed stamps |

**Returns:** `LocationProof` — Proof ready for verification

---

## astral.verify.*

Methods for verifying location proofs. These run server-side.

### stamp

Verify a stamp's internal validity (no claim assessment).

```typescript
const result = await astral.verify.stamp(stamp);
```

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `stamp` | `LocationStamp` | Yes | The stamp to verify |

**Returns:** `Promise<StampVerificationResult>`

```typescript
interface StampVerificationResult {
  valid: boolean;
  signaturesValid: boolean;
  structureValid: boolean;
  signalsConsistent: boolean;
  pluginResult: Record<string, unknown>;
}
```

### proof

Full verification of a location proof against its claim.

```typescript
const result = await astral.verify.proof(proof, options?);
```

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `proof` | `LocationProof` | Yes | The proof to verify |
| `options.chainId` | `number` | No | Chain for attestation signing |
| `options.submitOnchain` | `boolean` | No | Submit attestation onchain (default: false) |

**Returns:** `Promise<VerifiedLocationProof>`

```typescript
interface VerifiedLocationProof {
  proof: LocationProof;
  credibility: CredibilityAssessment;
  uid: string;
  attester: string;
  timestamp: number;
  chainId?: number;
}
```

**Example:**

```typescript
const result = await astral.verify.proof(proof, { chainId: 84532 });

if (result.credibility.confidence > 0.8) {
  console.log('High confidence location proof');
}
```

---

## Types

### PluginOptions

```typescript
interface PluginOptions {
  name: string;                         // "proofmode" | "witnesschain"
  version: string;                      // Semantic version
  config?: Record<string, unknown>;     // Plugin-specific config
}
```

### LocationClaim

Extends Location Protocol v0.2 with verification-specific fields.

```typescript
interface LocationClaim {
  // Location Protocol fields
  lpVersion: string;
  locationType: string;
  location: LocationData;
  srs: string;

  // Verification fields
  subject: SubjectIdentifier;
  radius: number;                       // Required — meters
  time: { start: number; end: number }; // Unix timestamps (seconds)
  eventType?: string;
}
```

### SubjectIdentifier

Follows [DID](https://www.w3.org/TR/did-core/) pattern.

```typescript
interface SubjectIdentifier {
  scheme: string;   // "eth-address" | "device-pubkey" | "did:web"
  value: string;
}

// Examples:
// { scheme: "eth-address", value: "0x1234..." }
// { scheme: "device-pubkey", value: "0xabcd..." }
```

### LocationStamp

Evidence conforming to Location Protocol for its location data.

```typescript
interface LocationStamp {
  // Location (LP v0.2) — observed location
  lpVersion: string;
  locationType: string;
  location: LocationData;
  srs: string;

  // Temporal
  temporalFootprint: { start: number; end: number };

  // Plugin
  plugin: string;
  pluginVersion: string;
  signals: Record<string, unknown>;
  signatures: Signature[];
}
```

### CredibilityAssessment

```typescript
interface CredibilityAssessment {
  confidence: number;                   // 0-1 (NOT calibrated probability)
  stampResults: StampResult[];
  correlation?: CorrelationAssessment;
  dimensions?: Record<string, number>;
}

interface StampResult {
  stampIndex: number;
  plugin: string;
  signaturesValid: boolean;
  structureValid: boolean;
  signalsConsistent: boolean;
  supportsClaim: boolean;
  claimSupportScore: number;
  pluginResult: Record<string, unknown>;
}

interface CorrelationAssessment {
  independence: number;    // 0-1
  agreement: number;       // 0-1
  notes: string[];
}
```

---

## Plugins

### Available Plugins

| Plugin | Environments | Evidence Type |
|--------|-------------|---------------|
| `proofmode` | iOS, Android, React Native | Hardware attestation, sensor fusion |
| `witnesschain` | Node.js server | Network latency, challenger attestations |

### Plugin-Specific Config

**ProofMode:**

```typescript
const signals = await astral.stamps.collect({
  name: 'proofmode',
  version: '0.1.0',
  config: {
    timeout: 5000,
    sensors: ['accelerometer', 'gyroscope']
  }
});
```

**WitnessChain:**

```typescript
const signals = await astral.stamps.collect({
  name: 'witnesschain',
  version: '0.1.0',
  config: {
    timeout: 10000,
    minChallengers: 3
  }
});
```

<Card title="API Reference: Verify" icon="code" href="/api-reference/verify">
  View the HTTP API documentation
</Card>
