---
title: "EAS"
description: "EAS submission helpers"
---

<Warning>
  **Development Preview** â€” The SDK is under development.
</Warning>

# EAS Methods

The `AstralEAS` class provides helpers for submitting attestations onchain using the EAS delegated attestation pattern.

## Setup

```typescript
import { AstralCompute, AstralEAS } from '@decentralized-geo/astral-compute';

const compute = new AstralCompute();
const eas = new AstralEAS(signer);
```

## submitDelegated()

Submit a delegated attestation onchain.

```typescript
eas.submitDelegated(
  delegatedAttestation: DelegatedAttestation
): Promise<TransactionReceipt>
```

### How It Works

1. **Astral signs** the attestation data offchain
2. **You submit** using Astral's signature (you pay gas)
3. **EAS verifies** the signature and records Astral as attester

### Example

```typescript
import { AstralCompute, AstralEAS } from '@decentralized-geo/astral-compute';

const compute = new AstralCompute();
const eas = new AstralEAS(signer);

// Get policy attestation from compute operation
const result = await compute.within(
  userLocationUID,
  landmarkUID,
  500,
  { schema: SCHEMA_UID, recipient: userAddress }
);

// Submit onchain if user is nearby
if (result.result) {
  const tx = await eas.submitDelegated(result.delegatedAttestation);
  await tx.wait();

  console.log('Attestation submitted!');
  console.log('Transaction hash:', tx.hash);
}
```

---

## Delegated Attestation Object

The compute API returns a `delegatedAttestation` object with all compute results:

```typescript
// From compute result
result.delegatedAttestation = {
  signature: string;   // Combined signature (r + s + v)
  attester: string;    // Astral signer address
  deadline: number;    // Unix timestamp for signature expiry
}
```

<Note>
  The EAS SDK expects a slightly different format for delegated attestations. The `AstralEAS` class
  handles the conversion automatically, transforming the compact API response into the full structure
  required by the EAS contract.
</Note>

---

## estimateGas()

Estimate gas before submitting to avoid failed transactions.

```typescript
eas.estimateGas(
  delegatedAttestation: DelegatedAttestation
): Promise<bigint>
```

### Example

```typescript
// Estimate gas before submitting
const gasEstimate = await eas.estimateGas(result.delegatedAttestation);
console.log('Estimated gas:', gasEstimate.toString());

// Proceed with submission if acceptable
const tx = await eas.submitDelegated(result.delegatedAttestation);
```

---

## Signature Expiry

Delegated attestation signatures have a deadline:

```typescript
const result = await compute.within(uid1, uid2, 500, options);

// Check if signature is still valid
if (Date.now() / 1000 < result.delegatedAttestation.deadline) {
  await eas.submitDelegated(result.delegatedAttestation);
} else {
  // Request a new computation
  const newResult = await compute.within(uid1, uid2, 500, options);
  await eas.submitDelegated(newResult.delegatedAttestation);
}
```

---

## Gas Costs

You pay gas when submitting:

```typescript
// Estimate gas
const gasEstimate = await eas.estimateGas(result.delegatedAttestation);
console.log('Estimated gas:', gasEstimate.toString());

// Submit with custom gas settings
const tx = await eas.submitDelegated(result.delegatedAttestation, {
  gasLimit: 200000,
  maxFeePerGas: ethers.parseUnits('50', 'gwei')
});
```

---

## Verifying Onchain

After submission, resolvers can verify:

```solidity
function onAttest(
    Attestation calldata attestation,
    uint256 /*value*/
) internal override returns (bool) {
    // Verify from Astral
    require(attestation.attester == astralSigner, "Not from Astral");

    // Decode and process
    (bool result, , , ) = abi.decode(
        attestation.data,
        (bool, bytes32[], uint64, string)
    );

    // ... business logic
}
```

---

## Why Delegated Attestations?

| Who | Does What |
|-----|-----------|
| **Astral** | Signs attestation offchain (proves computation) |
| **Developer** | Submits onchain (pays gas) |
| **EAS** | Records Astral as attester |
| **Resolver** | Verifies attester = Astral, executes logic |

This pattern means:
- Astral doesn't need to pay gas for every computation
- Developers control when/whether to submit onchain
- Smart contracts can verify attestations came from Astral

<Card title="Back: SDK Overview" icon="arrow-left" href="/sdk/overview">
  Return to SDK overview
</Card>
